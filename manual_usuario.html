<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Usuario - Dashboard de Ventas</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        @import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css");

        :root {
            --odoo-primary: #875A7B;
            --odoo-primary-dark: #6B4563;
            --text-primary: #2c3e50;
            --text-secondary: #555;
            --bg-light: #f8f9fa;
            --border-color: #e0e6ed;
            --accent-color: #3498db;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            line-height: 1.7;
            color: var(--text-secondary);
            background-color: #fdfdff;
            margin: 0;
            display: flex;
        }

        #toc {
            width: 280px;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            background: var(--bg-light);
            border-right: 1px solid var(--border-color);
            padding: 20px;
            overflow-y: auto;
        }

        #toc h2 {
            color: var(--odoo-primary);
            font-size: 1.5rem;
            margin-top: 0;
            border-bottom: 2px solid var(--odoo-primary-dark);
            padding-bottom: 10px;
        }

        #toc ul {
            list-style: none;
            padding: 0;
        }

        #toc li a {
            display: block;
            padding: 10px 15px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s ease-in-out;
            font-weight: 500;
        }

        #toc li a:hover, #toc li a.active {
            background-color: var(--odoo-primary);
            color: white;
            transform: translateX(5px);
        }

        main {
            margin-left: 320px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
        }

        section {
            margin-bottom: 60px;
            padding-top: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 30px;
        }

        h1, h2, h3 {
            color: var(--text-primary);
            font-weight: 600;
        }

        h1 {
            font-size: 2.8rem;
            color: var(--odoo-primary-dark);
            margin-bottom: 20px;
        }

        h2 {
            font-size: 2rem;
            border-bottom: 2px solid var(--odoo-primary);
            padding-bottom: 10px;
            margin-top: 0;
        }

        h3 {
            font-size: 1.4rem;
            color: var(--odoo-primary);
            margin-top: 30px;
        }

        p, li {
            font-size: 1rem;
        }

        code {
            background-color: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            color: #c7254e;
        }

        .note {
            background-color: #e7f3fe;
            border-left: 5px solid var(--accent-color);
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .note strong {
            color: var(--accent-color);
        }

        .screenshot {
            width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-top: 15px;
        }

        .bi {
            margin-right: 8px;
        }
    </style>
</head>
<body>

    <nav id="toc">
        <h2><i class="bi bi-book"></i>Manual</h2>
        <ul>
            <li><a href="#introduccion">Introducci√≥n</a></li>
            <li><a href="#inicio-sesion">Inicio de Sesi√≥n</a></li>
            <li><a href="#dashboard-internacional">Dashboard Internacional (Principal)</a></li>
            <li><a href="#gestion-metas-linea">Gesti√≥n de Metas (L√≠nea)</a></li>
            <li><a href="#gestion-metas-cliente">Gesti√≥n de Metas (Cliente)</a></li>
            <li><a href="#vistas-detalladas">Vistas Detalladas</a></li>
            <li><a href="#exportacion">Exportaci√≥n de Datos</a></li>
        </ul>
    </nav>

    <main>
        <h1><i class="bi bi-graph-up-arrow"></i>Manual de Usuario: Dashboard de Ventas</h1>

        <section id="introduccion">
            <h2><i class="bi bi-rocket-takeoff"></i>Introducci√≥n</h2>
            <p>
                Bienvenido al manual del Dashboard de Ventas. Esta aplicaci√≥n ha sido dise√±ada para proporcionar una visi√≥n clara y en tiempo real del rendimiento comercial de la empresa, tanto a nivel nacional como internacional.
            </p>
            <p>
                El sistema se conecta directamente con <strong>Odoo</strong> para obtener datos de ventas y con <strong>Google Sheets</strong> para gestionar las metas comerciales, ofreciendo una herramienta centralizada para el an√°lisis y la toma de decisiones.
            </p>
        </section>

        <section id="inicio-sesion">
            <h2><i class="bi bi-box-arrow-in-right"></i>Inicio de Sesi√≥n</h2>
            <p>
                Para acceder al sistema, deber√°s utilizar las mismas credenciales (usuario y contrase√±a) que usas para ingresar a Odoo.
            </p>
            <div class="note">
                <strong><i class="bi bi-key-fill"></i>Credenciales:</strong> Si tienes problemas para acceder, verifica que tu usuario y contrase√±a de Odoo sean correctos. El sistema valida la autenticaci√≥n directamente con el ERP.
            </div>
        </section>

        <section id="dashboard-internacional">
            <h2><i class="bi bi-globe2"></i>Dashboard Internacional (Principal)</h2>
            <p>
                Esta es la pantalla principal de la aplicaci√≥n. Ofrece una vista panor√°mica de las ventas internacionales del a√±o en curso.
            </p>
            <h3><i class="bi bi-funnel-fill"></i>Filtro por Cliente</h3>
            <p>
                En la parte superior izquierda, encontrar√°s un men√∫ desplegable para filtrar todos los datos del dashboard por un cliente espec√≠fico. Al seleccionar un cliente, todos los KPIs, tablas y gr√°ficos se recalcular√°n para mostrar √∫nicamente la informaci√≥n de ese cliente. Para ver los datos de todos los clientes, selecciona la opci√≥n "Todos los clientes".
            </p>
            <h3><i class="bi bi-bar-chart-line-fill"></i>KPIs Principales</h3>
            <p>
                La fila superior muestra los indicadores clave de rendimiento:
                <ul>
                    <li><strong>Venta Proyectada del A√±o:</strong> Suma de todo lo facturado en el a√±o m√°s los pedidos pendientes de facturar para el cliente seleccionado (o todos).</li>
                    <li><strong>Meta:</strong> La meta de ventas definida en la secci√≥n "Metas por Cliente". Si se selecciona un cliente, muestra la meta de ese cliente. Si no, muestra la suma de las metas de todos los clientes.</li>
                    <li><strong>Brecha Comercial:</strong> La diferencia entre la Venta Proyectada y la Meta.</li>
                    <li><strong>% Avance:</strong> El porcentaje de la meta que se ha alcanzado con la venta facturada.</li>
                </ul>
            </p>
            <h3><i class="bi bi-card-checklist"></i>An√°lisis por Cliente Seleccionado</h3>
            <p>
                Cuando filtras por un cliente espec√≠fico, el dashboard se transforma para ofrecerte un an√°lisis detallado de ese cliente:
            </p>
            <ul>
                <li><strong>Tarjeta de Avance de Facturaci√≥n:</strong> Aparece una nueva tarjeta en la parte superior que muestra el progreso de facturaci√≥n de los pedidos de ese cliente. Una barra de progreso con colores de sem√°foro (rojo, amarillo, verde) te permite evaluar r√°pidamente su estado.</li>
                <li><strong>Gr√°fico de Avance por Pedido:</strong> Justo debajo, ver√°s un gr√°fico que desglosa el avance de cada pedido individual del cliente. La barra principal representa el valor total original del pedido y la barra interior (bala) muestra cu√°nto se ha facturado. Incluye un bot√≥n "üì¶ Productos" que te permite alternar a una vista de tabla de productos.</li>
                <li><strong>Tabla de Productos del Cliente:</strong> Al hacer clic en "üì¶ Productos", accedes a una tabla detallada con todos los productos del cliente:
                    <ul>
                        <li><strong>Filtro de Estado:</strong> Selecciona entre "Todos", "Facturado" o "Por Facturar" (por defecto muestra Por Facturar).</li>
                        <li><strong>Filtro de L√≠nea Comercial:</strong> Selector desplegable que te permite filtrar por l√≠nea comercial espec√≠fica o ver todas.</li>
                        <li><strong>Informaci√≥n mostrada:</strong> C√≥digo del producto, nombre, l√≠nea comercial, cantidad total, monto total y estado con colores visuales (verde=facturado, naranja=por facturar, azul=mixto).</li>
                        <li><strong>Paginaci√≥n:</strong> Si hay m√°s de 15 productos, se activan controles de paginaci√≥n para navegar entre p√°ginas.</li>
                        <li><strong>Ordenamiento:</strong> Los productos se ordenan autom√°ticamente por monto de mayor a menor seg√∫n el filtro activo.</li>
                        <li><strong>Cerrar vista:</strong> Usa el bot√≥n "‚úï Cerrar" para regresar al gr√°fico de pedidos.</li>
                    </ul>
                </li>
            </ul>
            <div class="note">
                <strong><i class="bi bi-eye-slash-fill"></i>Ocultamiento de Gr√°fico General:</strong> Al seleccionar un cliente, el gr√°fico general "Avance de Facturaci√≥n por Cliente" se oculta para dar paso a la vista detallada.
            </div>



            <h3><i class="bi bi-table"></i>Tabla de Ventas por L√≠nea Comercial</h3>
            <p>
                Esta tabla desglosa el rendimiento por cada l√≠nea comercial internacional:
                <ul>
                    <li><strong>Venta Total ($):</strong> Lo que ya ha sido facturado para esa l√≠nea.</li>
                    <li><strong>Por Facturar ($):</strong> El valor de los pedidos de venta que est√°n confirmados pero a√∫n no se han facturado.</li>
                    <li><strong>% Part.:</strong> Porcentaje de participaci√≥n de la l√≠nea sobre la venta total.</li>
                    <li><strong>Meta:</strong> La meta espec√≠fica para esa l√≠nea, calculada a partir de los datos de "Metas por Cliente".</li>
                    <li><strong>Brecha:</strong> La diferencia entre la proyecci√≥n (Venta + Por Facturar) y la meta de la l√≠nea.</li>
                    <li><strong>% Avance:</strong> El progreso porcentual hacia la meta de la l√≠nea.</li>
                </ul>
            </p>
            <h3><i class="bi bi-pie-chart-fill"></i>Gr√°ficos de An√°lisis</h3>
            <p>
                La parte inferior del dashboard contiene varios gr√°ficos para un an√°lisis m√°s profundo:
                <ul>
                    <li><strong>Top Productos Facturados:</strong> Muestra los productos con mayor volumen de venta facturada.</li>
                    <li><strong>Venta Internacional por L√≠nea Comercial:</strong> Un resumen visual de la tabla principal.</li>
                    <li><strong>An√°lisis Jer√°rquico de Ventas:</strong> Un potente gr√°fico "drill-down" que te permite explorar las ventas a trav√©s de m√∫ltiples niveles. La nueva jerarqu√≠a es:
                        <ol>
                            <li>Clasificaci√≥n Farmacol√≥gica</li>
                            <li>Formas Farmac√©uticas</li>
                            <li>V√≠a de Administraci√≥n</li>
                            <li>L√≠nea de Producci√≥n</li>
                            <li>Producto</li>
                        </ol>
                        Al hacer clic en una barra, el gr√°fico de pastel "Venta por Clasificaci√≥n Farmacol√≥gica" se actualizar√° para mostrar el desglose del siguiente nivel.
                    </li>
                    <li><strong>Avance de Facturaci√≥n por Cliente:</strong> Un gr√°fico de tipo "bullet" que compara lo facturado contra el total de pedidos para cada cliente, mostrando el porcentaje de avance.</li>
                </ul>
            </p>
        </section>

        <section id="gestion-metas-linea">
            <h2><i class="bi bi-bullseye"></i>Gesti√≥n de Metas (por L√≠nea)</h2>
            <p>
                Esta secci√≥n (accesible desde el Dashboard Nacional) permite establecer las metas de venta mensuales para cada l√≠nea comercial nacional y para E-commerce. La interfaz ha sido redise√±ada para ser m√°s clara y moderna.
            </p>
            <ol>
                <li><strong>Selecciona un mes:</strong> Usa el selector de la parte superior para elegir el mes para el cual deseas definir las metas.</li>
                <li><strong>Ingresa las metas:</strong> Para cada l√≠nea comercial, ver√°s una "tarjeta" individual. Rellena los campos "Meta Total" y "Meta IPN".</li>
                <li><strong>Visualiza los totales:</strong> Una tarjeta de resumen en la parte inferior muestra la suma total de las metas que has ingresado, actualiz√°ndose en tiempo real.</li>
                <li><strong>Guarda los cambios:</strong> Haz clic en el bot√≥n <strong>"Guardar Metas"</strong>. Los datos se almacenar√°n en Google Sheets.</li>
            </ol>
        </section>

        <section id="gestion-metas-cliente">
            <h2><i class="bi bi-person-check-fill"></i>Gesti√≥n de Metas (por Cliente)</h2>
            <p>
                Esta secci√≥n, accesible desde el men√∫ de navegaci√≥n del Dashboard Internacional, es donde se definen las metas de venta anuales para cada cliente internacional. Estos datos son la base para los KPIs y la tabla de rendimiento del dashboard.
            </p>
            <ol>
                <li><strong>Selecciona un a√±o:</strong> Usa el men√∫ desplegable en la parte superior para elegir el a√±o para el cual deseas ver o editar las metas.</li>
                <li><strong>Ingresa las metas:</strong> La p√°gina muestra una tabla con todos los clientes internacionales. Para cada cliente, puedes ingresar la meta de venta anual en las columnas correspondientes a cada l√≠nea comercial (AGROVET, PETMEDICA, AVIVET).</li>
                <li><strong>C√°lculos autom√°ticos:</strong>
                    <ul>
                        <li>La columna <strong>"Total Cliente ($)"</strong> se actualiza autom√°ticamente a medida que ingresas los n√∫meros, mostrando la meta total para cada cliente.</li>
                        <li>La fila inferior <strong>"Total por L√≠nea"</strong> suma las metas de todos los clientes para cada l√≠nea comercial.</li>
                        <li>La celda <strong>"Total General"</strong> muestra la suma de todas las metas.</li>
                    </ul>
                </li>
                <li><strong>Guarda los cambios:</strong> Cuando termines, haz clic en el bot√≥n <strong>"Guardar Metas"</strong>. Los datos se almacenar√°n en Google Sheets y se usar√°n en el dashboard principal.</li>
            </ol>
            <div class="note">
                <strong><i class="bi bi-check-circle-fill"></i>Persistencia de Datos:</strong> Despu√©s de guardar, los valores que ingresaste permanecer√°n en los campos, permiti√©ndote continuar editando o verificando sin que se borren.
            </div>
        </section>

        <section id="vistas-detalladas">
            <h2><i class="bi bi-layout-text-sidebar-reverse"></i>Vistas Detalladas</h2>
            <p>
                Desde el men√∫ de navegaci√≥n superior, puedes acceder a vistas de tabla detalladas:
            </p>
            <ul>
                <li><strong>Ventas (<code>/sales</code>):</strong> Muestra una tabla con todas las l√≠neas de facturas de venta internacionales. Incluye filtros por fecha, cliente y un campo de b√∫squeda general.</li>
                <li><strong>Pendientes (<code>/pending</code>):</strong> Muestra una tabla con todos los pedidos de venta internacionales que est√°n pendientes de facturar. Tambi√©n cuenta con filtros similares.</li>
            </ul>
        </section>

        <section id="exportacion">
            <h2><i class="bi bi-file-earmark-excel-fill"></i>Exportaci√≥n de Datos</h2>
            <p>
                La aplicaci√≥n permite exportar datos a formato <strong>Excel (.xlsx)</strong> desde varias ubicaciones:
            </p>
            <ul>
                <li><strong>Desde el Dashboard Internacional:</strong> En la tabla de "Total por L√≠nea Comercial", encontrar√°s dos botones:
                    <ul>
                        <li><code>Exp. Facturado</code>: Descarga un detalle de todas las ventas ya facturadas para el cliente seleccionado (o todos si no hay selecci√≥n).</li>
                        <li><code>Exp. Por Facturar</code>: Descarga un detalle de todos los pedidos pendientes de facturar.</li>
                    </ul>
                </li>
                <li><strong>Desde las Vistas Detalladas:</strong> En las p√°ginas <code>/sales</code> y <code>/pending</code>, tambi√©n encontrar√°s botones para exportar los datos que se est√°n visualizando.</li>
            </ul>
        </section>

    </main>

    <script>
        // Script para resaltar la secci√≥n activa en la tabla de contenidos
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('#toc a');

            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href').substring(1) === entry.target.id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { threshold: 0.5 });

            sections.forEach(section => {
                observer.observe(section);
            });
        });
    </script>

</body>
</html>